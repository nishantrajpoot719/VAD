2025-05-29 22:16:09,020 - __main__ - INFO - ========================= NEW SESSION STARTED AT 2025-05-29 22:16:09 =========================
2025-05-29 22:16:12,879 - __main__ - INFO - Initialized OpenSMILE with eGeMAPS feature set: 88 features
2025-05-29 22:16:12,881 - __main__ - INFO - Starting FFmpeg setup
2025-05-29 22:16:12,881 - __main__ - INFO - Application directory: E:\Country Delight\flutterflow video processing
2025-05-29 22:16:12,881 - __main__ - INFO - Looking for ffmpeg in: E:\Country Delight\flutterflow video processing\ffmpeg_binary
2025-05-29 22:16:12,881 - __main__ - INFO - Found ffmpeg_binary directory at: E:\Country Delight\flutterflow video processing\ffmpeg_binary
2025-05-29 22:16:12,881 - __main__ - INFO - Contents of ffmpeg_binary directory: ['ffmpeg.exe']
2025-05-29 22:16:12,881 - __main__ - INFO - Checking for ffmpeg at: E:\Country Delight\flutterflow video processing\ffmpeg_binary\ffmpeg.exe
2025-05-29 22:16:12,881 - __main__ - INFO - Found ffmpeg executable at: E:\Country Delight\flutterflow video processing\ffmpeg_binary\ffmpeg.exe
2025-05-29 22:16:12,886 - __main__ - INFO - ffmpeg file size: 134163456 bytes, executable: True
2025-05-29 22:16:12,886 - __main__ - INFO - Testing FFmpeg integration
2025-05-29 22:16:12,886 - __main__ - INFO - Testing pydub integration with ffmpeg...
2025-05-29 22:16:12,892 - __main__ - INFO - Pydub integration passed - created test file at C:\Users\Nishant\AppData\Local\Temp\tmprq8fp0bb\test_audio.wav
2025-05-29 22:16:12,892 - __main__ - INFO - Testing MoviePy with ffmpeg at: E:\Country Delight\flutterflow video processing\ffmpeg_binary\ffmpeg.exe
2025-05-29 22:16:12,892 - __main__ - INFO - Testing AudioFileClip with C:\Users\Nishant\AppData\Local\Temp\tmp9w1q1z7m\test.wav
2025-05-29 22:16:14,009 - __main__ - INFO - MoviePy integration passed
2025-05-29 22:16:14,010 - __main__ - INFO - All FFmpeg integrations successful
2025-05-29 22:16:14,010 - __main__ - INFO - === Starting Final VAD + Contextual Pipeline ===
2025-05-29 22:16:14,010 - __main__ - DEBUG - Starting video processing
2025-05-29 22:16:14,013 - __main__ - DEBUG - Created temp video directory: C:\Users\Nishant\AppData\Local\Temp\tmpguyeaiy7
2025-05-29 22:16:14,157 - __main__ - DEBUG - Sampling 21 frames with interval 6
2025-05-29 22:16:16,338 - __main__ - DEBUG - Processing 21 frames in parallel with 6 workers
2025-05-29 22:16:17,225 - __main__ - DEBUG - Trying face detection with backend: opencv
2025-05-29 22:16:18,145 - __main__ - DEBUG - Trying face detection with backend: opencv
2025-05-29 22:16:18,196 - __main__ - DEBUG - Trying face detection with backend: opencv
2025-05-29 22:16:18,279 - __main__ - DEBUG - Trying face detection with backend: opencv
2025-05-29 22:16:18,287 - __main__ - DEBUG - Trying face detection with backend: opencv
2025-05-29 22:16:18,330 - __main__ - DEBUG - Trying face detection with backend: opencv
2025-05-29 22:16:20,109 - h5py._conv - DEBUG - Creating converter from 3 to 5
2025-05-29 22:16:20,449 - __main__ - DEBUG - Frame 18: Detected emotion 'neutral' with backend opencv
2025-05-29 22:16:20,449 - __main__ - DEBUG - Processed frame 1/21
2025-05-29 22:16:20,496 - __main__ - DEBUG - Frame 0: Detected emotion 'neutral' with backend opencv
2025-05-29 22:16:20,496 - __main__ - DEBUG - Processed frame 2/21
2025-05-29 22:16:20,918 - __main__ - DEBUG - Frame 12: Detected emotion 'neutral' with backend opencv
2025-05-29 22:16:20,918 - __main__ - DEBUG - Processed frame 3/21
2025-05-29 22:16:20,934 - __main__ - DEBUG - Trying face detection with backend: opencv
2025-05-29 22:16:20,979 - __main__ - DEBUG - Frame 30: Detected emotion 'neutral' with backend opencv
2025-05-29 22:16:20,981 - __main__ - DEBUG - Processed frame 4/21
2025-05-29 22:16:21,278 - __main__ - DEBUG - Frame 6: Detected emotion 'neutral' with backend opencv
2025-05-29 22:16:21,288 - __main__ - DEBUG - Frame 24: Detected emotion 'neutral' with backend opencv
2025-05-29 22:16:21,288 - __main__ - DEBUG - Processed frame 5/21
2025-05-29 22:16:21,296 - __main__ - DEBUG - Processed frame 6/21
2025-05-29 22:16:21,343 - __main__ - DEBUG - Trying face detection with backend: opencv
2025-05-29 22:16:21,726 - __main__ - DEBUG - Trying face detection with backend: opencv
2025-05-29 22:16:22,216 - __main__ - DEBUG - Trying face detection with backend: opencv
2025-05-29 22:16:22,666 - __main__ - DEBUG - Trying face detection with backend: opencv
2025-05-29 22:16:23,079 - __main__ - DEBUG - Trying face detection with backend: opencv
2025-05-29 22:16:23,200 - __main__ - DEBUG - Frame 42: Detected emotion 'neutral' with backend opencv
2025-05-29 22:16:23,260 - __main__ - DEBUG - Processed frame 7/21
2025-05-29 22:16:23,586 - __main__ - DEBUG - Frame 60: Detected emotion 'neutral' with backend opencv
2025-05-29 22:16:23,586 - __main__ - DEBUG - Processed frame 8/21
2025-05-29 22:16:24,307 - __main__ - DEBUG - Frame 36: Detected emotion 'neutral' with backend opencv
2025-05-29 22:16:24,307 - __main__ - DEBUG - Processed frame 9/21
2025-05-29 22:16:24,335 - __main__ - DEBUG - Frame 54: Detected emotion 'neutral' with backend opencv
2025-05-29 22:16:24,338 - __main__ - DEBUG - Processed frame 10/21
2025-05-29 22:16:24,463 - __main__ - DEBUG - Frame 48: Detected emotion 'neutral' with backend opencv
2025-05-29 22:16:24,463 - __main__ - DEBUG - Processed frame 11/21
2025-05-29 22:16:24,732 - __main__ - DEBUG - Trying face detection with backend: opencv
2025-05-29 22:16:24,804 - __main__ - DEBUG - Trying face detection with backend: opencv
2025-05-29 22:16:24,970 - __main__ - DEBUG - Trying face detection with backend: opencv
2025-05-29 22:16:25,864 - __main__ - DEBUG - Trying face detection with backend: opencv
2025-05-29 22:16:25,961 - __main__ - DEBUG - Trying face detection with backend: opencv
2025-05-29 22:16:26,152 - __main__ - DEBUG - Frame 72: Detected emotion 'neutral' with backend opencv
2025-05-29 22:16:26,154 - __main__ - DEBUG - Processed frame 12/21
2025-05-29 22:16:26,651 - __main__ - DEBUG - Frame 66: Detected emotion 'neutral' with backend opencv
2025-05-29 22:16:26,655 - __main__ - DEBUG - Processed frame 13/21
2025-05-29 22:16:26,709 - __main__ - DEBUG - Trying face detection with backend: opencv
2025-05-29 22:16:27,073 - __main__ - DEBUG - Trying face detection with backend: opencv
2025-05-29 22:16:27,550 - __main__ - DEBUG - Frame 84: Detected emotion 'neutral' with backend opencv
2025-05-29 22:16:27,550 - __main__ - DEBUG - Processed frame 14/21
2025-05-29 22:16:28,009 - __main__ - DEBUG - Frame 78: Detected emotion 'neutral' with backend opencv
2025-05-29 22:16:28,009 - __main__ - DEBUG - Processed frame 15/21
2025-05-29 22:16:28,046 - __main__ - DEBUG - Trying face detection with backend: opencv
2025-05-29 22:16:28,399 - __main__ - DEBUG - Frame 90: Detected emotion 'neutral' with backend opencv
2025-05-29 22:16:28,448 - __main__ - DEBUG - Processed frame 16/21
2025-05-29 22:16:28,953 - __main__ - DEBUG - Frame 96: Detected emotion 'neutral' with backend opencv
2025-05-29 22:16:28,953 - __main__ - DEBUG - Processed frame 17/21
2025-05-29 22:16:29,236 - __main__ - DEBUG - Frame 114: Detected emotion 'neutral' with backend opencv
2025-05-29 22:16:29,236 - __main__ - DEBUG - Processed frame 18/21
2025-05-29 22:16:29,311 - __main__ - DEBUG - Trying face detection with backend: opencv
2025-05-29 22:16:29,376 - __main__ - DEBUG - Frame 102: Detected emotion 'neutral' with backend opencv
2025-05-29 22:16:29,376 - __main__ - DEBUG - Processed frame 19/21
2025-05-29 22:16:29,630 - __main__ - DEBUG - Frame 108: Detected emotion 'neutral' with backend opencv
2025-05-29 22:16:29,630 - __main__ - DEBUG - Processed frame 20/21
2025-05-29 22:16:30,062 - __main__ - DEBUG - Frame 120: Detected emotion 'neutral' with backend opencv
2025-05-29 22:16:30,062 - __main__ - DEBUG - Processed frame 21/21
2025-05-29 22:16:30,235 - __main__ - INFO - Video emotion detection results: {'neutral': 21}
2025-05-29 22:16:30,235 - __main__ - INFO - Detected emotions: ['neutral', 'neutral', 'neutral', 'neutral', 'neutral', 'neutral', 'neutral', 'neutral', 'neutral', 'neutral']...
2025-05-29 22:16:30,235 - __main__ - INFO - Video processing completed successfully with 21 emotions detected
2025-05-29 22:16:30,235 - __main__ - INFO - Primary video emotion: neutral (confidence: 0.5)
2025-05-29 22:16:30,242 - __main__ - INFO - Starting audio processing for WhatsApp Video 2025-05-19 at 11.04.45_0a7f6ac5.mp4
2025-05-29 22:16:30,242 - __main__ - DEBUG - Created temp audio directory: C:\Users\Nishant\AppData\Local\Temp\tmpuz9rbwfp
2025-05-29 22:16:30,722 - __main__ - INFO - Skipping moviepy audio extraction and using ffmpeg directly
2025-05-29 22:16:30,727 - audio_preprocessing - INFO - Found FFmpeg in ffmpeg_binary directory: E:\Country Delight\flutterflow video processing\ffmpeg_binary\ffmpeg.exe
2025-05-29 22:16:30,727 - __main__ - INFO - Using ffmpeg for audio extraction: E:\Country Delight\flutterflow video processing\ffmpeg_binary\ffmpeg.exe
2025-05-29 22:16:30,727 - __main__ - INFO - Running ffmpeg command: E:\Country Delight\flutterflow video processing\ffmpeg_binary\ffmpeg.exe -i C:\Users\Nishant\Downloads\WhatsApp Video 2025-05-19 at 11.04.45_0a7f6ac5.mp4 -vn -acodec pcm_s16le -ar 22050 -ac 1 -y C:\Users\Nishant\AppData\Local\Temp\tmpuz9rbwfp\original_audio.wav
2025-05-29 22:16:30,822 - __main__ - INFO - ffmpeg extraction succeeded: C:\Users\Nishant\AppData\Local\Temp\tmpuz9rbwfp\original_audio.wav
2025-05-29 22:16:30,831 - __main__ - INFO - Successfully extracted audio to C:\Users\Nishant\AppData\Local\Temp\tmpuz9rbwfp\original_audio.wav
2025-05-29 22:16:30,831 - __main__ - DEBUG - Audio too short for silence removal, using as is
2025-05-29 22:16:30,834 - audio_preprocessing - INFO - Found FFmpeg in ffmpeg_binary directory: E:\Country Delight\flutterflow video processing\ffmpeg_binary\ffmpeg.exe
2025-05-29 22:16:30,834 - audio_preprocessing - DEBUG - Running ffmpeg preprocessing command: E:\Country Delight\flutterflow video processing\ffmpeg_binary\ffmpeg.exe -i C:\Users\Nishant\AppData\Local\Temp\tmpuz9rbwfp\original_audio.wav -ar 22050 -ac 1 -acodec pcm_s16le -y C:\Users\Nishant\AppData\Local\Temp\tmpuz9rbwfp\preprocessed_original_audio.wav
2025-05-29 22:16:30,884 - audio_preprocessing - DEBUG - FFmpeg preprocessing completed successfully
2025-05-29 22:16:30,884 - audio_preprocessing - DEBUG - Successfully preprocessed audio file: C:\Users\Nishant\AppData\Local\Temp\tmpuz9rbwfp\preprocessed_original_audio.wav
2025-05-29 22:16:30,884 - __main__ - INFO - Audio preprocessed successfully: C:\Users\Nishant\AppData\Local\Temp\tmpuz9rbwfp\preprocessed_original_audio.wav
2025-05-29 22:16:31,065 - __main__ - INFO - Successfully extracted 1 audio features
2025-05-29 22:16:31,065 - __main__ - WARNING - Unexpected feature count: got 1, expected 88
2025-05-29 22:16:31,070 - __main__ - DEBUG - Sample features: {('C:\\Users\\Nishant\\AppData\\Local\\Temp\\tmpuz9rbwfp\\preprocessed_original_audio.wav', Timedelta('0 days 00:00:00'), Timedelta('0 days 00:00:04.266666667')): 19.903488159179688}
2025-05-29 22:16:31,070 - improved_ravdess_integration - INFO - Transposing features from shape (88, 1) to match expected format
2025-05-29 22:16:31,077 - improved_ravdess_integration - DEBUG - Audio feature statistics: {'shape': (1, 88), 'nan_count': np.int64(0), 'nan_percentage': '0.00%', 'mean': np.float32(95.51669), 'std': nan, 'min': np.float32(-125.827576), 'max': np.float32(2699.8577)}
2025-05-29 22:16:31,081 - improved_ravdess_integration - DEBUG - Audio feature statistics: {'shape': (1, 88), 'nan_count': np.int64(0), 'nan_percentage': '0.00%', 'mean': np.float32(95.51669), 'std': nan, 'min': np.float32(-125.827576), 'max': np.float32(2699.8577)}
2025-05-29 22:16:31,081 - improved_ravdess_integration - INFO - Loading emotion model from audio_emotion_classifier_egemaps.pkl...
2025-05-29 22:16:31,092 - improved_ravdess_integration - INFO - Model loaded with classes: ['angry' 'calm' 'disgust' 'fearful' 'happy' 'neutral' 'sad' 'surprised']
2025-05-29 22:16:31,092 - improved_ravdess_integration - INFO - Feature scaler loaded from audio_feature_scaler_egemaps.pkl
2025-05-29 22:16:31,092 - improved_ravdess_integration - DEBUG - Using SVM for emotion prediction
2025-05-29 22:16:31,092 - improved_ravdess_integration - DEBUG - Audio features shape: (1, 88)
2025-05-29 22:16:31,113 - improved_ravdess_integration - INFO - Top emotions: [('angry', 0.28634490881700997), ('sad', 0.17459349510920283), ('surprised', 0.13673412041020352)]
2025-05-29 22:16:31,113 - improved_ravdess_integration - INFO - Model predicted angry with confidence 0.29
2025-05-29 22:16:31,113 - improved_ravdess_integration - INFO - Final prediction: angry (0.29) using SVM model
2025-05-29 22:16:31,113 - __main__ - INFO - Audio emotion detected: angry with confidence 0.29
2025-05-29 22:16:31,113 - __main__ - INFO - Top 3 emotions: [('angry', 0.28634490881700997), ('sad', 0.17459349510920283), ('surprised', 0.13673412041020352), ('neutral', 0.11142487718815797)]
2025-05-29 22:16:31,113 - __main__ - INFO - Audio emotion: angry (confidence: 0.5)
2025-05-29 22:16:31,113 - __main__ - DEBUG - Converted emotion 'neutral' to VAD values: [0.0, 0.0, 0.0]
2025-05-29 22:16:31,115 - __main__ - DEBUG - Converted emotion 'angry' to VAD values: [-0.5, 0.7, 0.3]
2025-05-29 22:16:31,119 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): ipinfo.io:80
2025-05-29 22:16:32,007 - urllib3.connectionpool - DEBUG - http://ipinfo.io:80 "GET /json HTTP/1.1" 200 None
2025-05-29 22:16:32,011 - geocoder.base - INFO - Requested http://ipinfo.io/json
2025-05-29 22:16:32,012 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): api.openweathermap.org:443
2025-05-29 22:16:32,242 - urllib3.connectionpool - DEBUG - https://api.openweathermap.org:443 "GET /data/2.5/weather?lat=28.6519&lon=77.2315&appid=0341599fc3fc9da59ce4bdc61fba34fd&units=metric HTTP/1.1" 200 497
2025-05-29 22:16:32,242 - __main__ - INFO - Pipeline completed successfully.
2025-05-29 22:16:32,401 - groq._base_client - DEBUG - Request options: {'method': 'post', 'url': '/openai/v1/chat/completions', 'files': None, 'idempotency_key': 'stainless-python-retry-253d1c06-ca6a-431c-ad86-28777d96b208', 'json_data': {'messages': [{'role': 'system', 'content': 'This system contains Input, Product dictionary you have to infer from input and recommend top three products and top three product combos from the product dictionary only which a person should consume at that particular time.\n\nInput: [VAD, Intent, Contextual Data], where VAD is a list containing Valence, Arousal, and Dominance values respectively for the user\'s emotion (VAD values varies from -1 to 1 not 0 to 1 so there might be cases where all three values are positive that doesn\'t mean they are in scale of 0 to 1 they are always in scale of -1 to +1), VAD score should be used to figure out what type of food the user should consume depending on the valence, arousal, and dominance data. Intent is a list that contains the user\'s preferences ["Hot", "Light", "Tangy"] about the product he wants to consume you should infer from this data for deciding the user preference upon which you should top 3 products to recommend there might be cases when intent list only contains one or two elements instead of three, in that case, you should consider only those preferences which are in the list and assuming other to be null. contextual data is also a list containing [time, date, location, weather] this is also an important part of our system. lets suppose according to the user\'s emotion and preference you have 5 items to recommend then use contextual data to re-arrange between them as first, second and third, the way you should do this is time, date, and weather. so basically see what time of the day it is and what type of food user should have at that particular time, from date you should find out if there is any festival in India on those particular day(here you can also see to 3 before and 3 after days of weeks as well if there is upcoming or there was any festival nearby this date), if yes then use this data as well for rearranging the recommendation, and from the weather use it to recommend the products that will suit at that particular weather(e.g. on sunny days recommend cooling products on the top). So basically you should use contextual data for final rearranging the products in between them so that we can come up with best top 3 recommendations. And keep in mind you should use contextual data only for rearranging between the products not deciding, products decision should be made only from VAD score and Intent list. Contextual data is just like oregano over pizza which enhance the taste of pizza but doesn\'t alter what it contain.\n\nProduct Dictionary: {\n    "Malabar Parata": {\n        "variants": [],\n        "description": "A flaky, layered Indian bread usually served hot with pickles or curries. Malabar Parata is a beloved staple in South Indian coastal cuisine."\n    }, \n    "Pickles": {\n        "variants": [],\n        "description": "Pickles are vegetables or fruits preserved in a solution of vinegar, brine, or other acidic mediums, often enhanced with spices. A delicious and satisfying food item with tangy, salty, and sometimes spicy flavor, suitable for snacks or meals, paired with Malabar Parata only."\n    },\n    "Chaach": {\n        "variants": [\n            "Taaza Jeera Chaach",\n            "Taaza Pudina Masala Chaach"\n        ],\n        "description": "A traditional, spiced yogurt-based drink(made with yogurt, spices, and herbs also known as buttermilk) served chilled for digestive and cooling benefits. Known for its tangy cumin or mint undertones."\n    },\n    "Yogurt": {\n        "variants": [\n            "Mango Yogurt",\n            "Blueberry Yogurt",\n            "Strawberry Yogurt",\n            "Mango Badam Drinking yogurt [Probiotic]",\n            "Vanilla Badam Drinking Yogurt [Probiotic]",\n            "Strawberry Badam Drinking Yogurt [Probiotic]"\n        ],\n        "description": "A creamy, refreshing, and tangy dairy snack or drink, rich in probiotics and great for any time of the day. Flavors range from sweet mango to tangy berries or nutty probiotic drinks. yogurt is a versatile and nutritious food."\n    },\n    "Chocolate": {\n        "variants": [\n            "Dark Chocolate 55% - Nuts Infused",\n            "Dark Chocolate - 55%",\n            "Milk Chocolate - Nutty & Creamy"\n        ],\n        "description": "A sweet indulgence made from cocoa bean, ideal for satisfying dessert cravings and lifting mood. Available in dark or milk forms, often blended with nuts."\n    },\n    "Butter": {\n        "variants": [\n            "Unsalted Butter",\n            "Salted Butter"\n        ],\n        "description": "A delicious and satisfying food item suitable for snacks or meals. Paired only with Malabar Parata or any bread. Choose between rich salted or classic unsalted profiles."\n    },\n    "Bread": {\n        "variants": [\n            "Multigrain Bread",\n            "White Bread",\n            "Brown Bread"\n        ],\n        "description": "A baked staple available in different types, commonly used for toast or sandwiches, Paired with Butter, Jam, or Peanut butter. Multigrain offers fiber, white is soft, and brown is wholesome."\n    },\n    "Butter Atta Biscuit": {\n        "variants": [],\n        "description": "Crunchy or chewy baked snacks often paired with tea or coffee or with Milk only."\n    },\n    "Milk": {\n        "variants": [\n            "Chocolate Milk",\n            "Kesar Milk"\n        ],\n        "description": "A nutrient-rich drink consumed plain or flavored, often paired with bread, cereals, or Muesli and Flakes. Flavored options like Kesar and Chocolate enhance indulgence."\n    },\n    "Muesli and Flakes": {\n        "variants": [\n            "Corn Flakes",\n            "Muesli",\n            "Chocolate Flakes",\n            "Chocolate Muesli"\n        ],\n        "description": "A dry breakfast cereal typically consumed with milk, providing fiber and light energy to start your day. and chocolate ones are also ideal for satisfying dessert cravings or lifting mood. Chocolate versions add a dessert-like twist."\n    },\n    "Malai Peda": {\n        "variants": [],\n        "description": "Rich Indian sweets made from milk solids or lentils, usually enjoyed during festivals or as a 0dessert or for lifting mood. Made from reduced milk, offering a soft, melt-in-mouth texture."\n    },\n    "Lassi": {\n        "variants": [\n            "Mango Lassi",\n            "Punjabi Lassi"\n        ],\n        "description": "A traditional, spiced yogurt-based drink served chilled for digestive and cooling benefits. Comes in fruity or traditional creamy styles."\n    },\n    "Gulab Jamun": {\n        "variants": [],\n        "description": "A fruity, sweet spread commonly enjoyed on bread or toast for breakfast, as a dessert or for lifting mood. Deep-fried dough balls soaked in cardamom-scented syrup."\n    },\n    "Kaju Katli": {\n        "variants": [],\n        "description": "Rich Indian sweets made from milk solids or lentils, usually enjoyed during festivals, as desserts, or for lifting mood. Smooth cashew fudge with a hint of cardamom."\n    },\n    "Honey": {\n        "variants": [\n            "Farm Honey",\n            "Wild Forest Honey"\n        ],\n        "description": "A natural sweetener used in cooking or as a healthy sugar substitute in drinks and spreads. Farm honey is mild and sweet; Wild forest honey has deeper, earthy notes."\n    },\n    "Sweet Corn": {\n        "variants": [],\n        "description": "A delicious and satisfying food item suitable for snacks or meals. Rich in fiber, vitamins, and antioxidants, sweet corn is both a tasty and nutritious addition to meals."\n    },\n    "Sprouts": {\n        "variants": [],\n        "description": "Fresh and light ingredients typically used in salads or eaten raw for health benefits. Low-calorie, hydrating, and nutrient-packed."\n    },\n    "Cookies": {\n        "variants": [\n            "Kaju Pista Cookies",\n            "Choco-Chip Cookies"\n        ],\n        "description": "Crunchy or chewy baked snacks often paired with tea, coffee, or milk. Kaju Pista is nutty and traditional, and Choco-chip is rich and indulgent."\n    },\n    "Jam": {\n        "variants": [\n            "Mixed Fruit Jam",\n            "Strawberry Jam"\n        ],\n        "description": "A fruity, sweet spread commonly enjoyed on bread or toast for breakfast. Paired with bread only. Mixed fruit is vibrant and tangy; strawberry is a sweet classic."\n    },\n    "Coffee": {\n        "variants": [\n            "Instant 100% Coffee",\n            "Instant Chicory Blend Coffee"\n        ],\n        "description": "A hot or cold brewed beverage known for its bold flavor and stimulating properties. Chicory blend adds depth, while 100% coffee is pure and bold."\n    },\n    "Makhana": {\n        "variants": [\n            "Roasted Makhana - Cheese",\n            "Roasted Makhana - Ghee Turmeric",\n            "Roasted Makhana - Himalayan Pink Salt",\n            "Roasted Makhana - Salt & Pepper",\n            "Roasted Makhana - Chatpata Pudina"\n        ],\n        "description": "Lightly roasted lotus seeds offering a crunchy and low-calorie snacking option, ideal for munching anytime. Flavored with herbs, cheese, or spice for variety."\n    },\n    "Chips": {\n        "variants": [\n            "Cream & Onion - Potato Chips",\n            "Salted - Potato Chips",\n            "Magic Masala - Potato Chips",\n            "Hot \'N\' Sweet Chilli - Potato Chips",\n            "Tangy Tomato Chips",\n            "Flaming Hot - Spicy(Potato Chips)",\n            "Cheesy Chips",\n            "Banana Chips"\n        ],\n        "description": "Crunchy, salty snacks flavored in various styles, ideal for munching anytime. Can be bundled with them themselves, Can be Suggested as a combo of any number of them, or in combo with No Maida Puffs, Krunchy Puffs Magic Masala, Krunchy Stix. Ranges from cheesy to spicy, with options like Tomato, Chilli, and Banana."\n    },\n    "No Maida Puffs": {\n        "variants": [\n            "Disney Cream & Onion Puffs",\n            "Disney Noodle Masala Puffs"\n        ],\n        "description": "Crunchy, salty snacks flavored in various styles, ideal for munching anytime. Can be bundled with them themselves, Can be Suggested as a combo of any number of them, or in combo with Chips, Krunchy Puffs Magic Masala, Krunchy Stix. Comes in masala, mint, and noodle-inspired flavors."\n    },\n    "Krunchy Puffs Magic Masala": {\n        "variants": [],\n        "description": "Crunchy, salty snacks flavored in various styles, ideal for munching anytime. Can be bundled with them themselves, Can be Suggested as a combo of any number of them, or in combo with No Maida Puffs, Chips, Krunchy Stix."\n    },\n    "Krunchy Stix": {\n        "variants": [\n            "Noodle Masala Krunchy Stix",\n            "Mint Chutney Krunchy Stix",\n            "Magic Masala Krunchy Stix"\n        ],\n        "description": "Crunchy, salty snacks flavored in various styles, ideal for munching anytime. Can be bundled with them themselves, Can be Suggested as a combo of any number of them, or in combo with No Maida Puffs, Krunchy Puffs Magic Masala, Chips Comes in masala, mint, and noodle-inspired flavors."\n    },\n    "Chikki": {\n        "variants": [\n            "Peanut Chikki",\n            "Peanut Chikki Gud Patti"\n        ],\n        "description": "A delicious and satisfying food item suitable for snacks, meals, or as dessert. Crunchy, sweet, and jaggery-based with roasted peanuts."\n    },\n    "Aloo Bhujia": {\n        "variants": [],\n        "description": "Savory, crunchy Indian snacks often enjoyed with tea, as snack or as appetizers. ideal for munching anytime. Spiced and deep-fried for maximum flavor impact."\n    },\n    "Dry Bhel": {\n        "variants": [],\n        "description": "A popular Indian snack made with puffed rice, sev (crunchy chickpea noodles), roasted peanuts, and a mix of tangy and spicy chutneys or masalas. Unlike its wetter counterpart, it’s served without tamarind sauce, making it crisp, light, and easy to enjoy on the go. Garnished with chopped onions, tomatoes, coriander, and a squeeze of lime. A delicious and satisfying food item suitable for snacks or meals. ideal for munching anytime."\n    },\n    "Spiced Coated Peanuts": {\n        "variants": [],\n        "description": "Spiced Coated Peanuts are a bold and crunchy snack made by roasting premium peanuts and coating them with a flavorful blend of spices. With a crispy outer layer and a savory, slightly spicy kick, perfect for snacking on the go. Irresistibly addictive, these peanuts offer the ideal balance of heat, crunch, and nutty richness. Ideal for munching anytime."\n    },\n    "Moong Dal Namkeen": {\n        "variants": [],\n        "description": "Savory, crispy, crunchy Indian snacks made from split green gram (moong dal) that is deep-fried to golden perfection and lightly seasoned with salt and spices. Known for its light texture and addictive crunch. Often enjoyed with tea, as snack, or as appetizer. and ideal for munching anytime. Spiced and deep-fried for maximum flavor impact."\n    },\n    "Mathri": {\n        "variants": [\n            "Ajwain Mathri",\n            "Methi Mathri"\n        ],\n        "description": "Savory, crunchy Indian snack known for its crisp texture and rich flavor seasoned with spices like ajwain (carom seeds), black pepper, and sometimes kasuri methi. Often enjoyed with tea, as snack, or as appetizers, and is a staple during festivals. and ideal for munching anytime. Spiced and deep-fried for maximum flavor impact."\n    },\n    "Farsan": {\n        "variants": [\n            "Mix Namkeen"\n        ],\n        "description": "Savory, crunchy, and flavorful Indian snack blend, combining an assortment of savory fried lentils, chickpeas, nuts, and spices. Perfectly spiced and balanced, it offers a delightful mix of textures and tastes often enjoyed with tea, as snack, or as appetizer. and ideal for munching anytime, or on festive occasions."\n    },\n    "Salted and Roasted": {\n        "variants": [\n            "Salted Roasted Chana",\n            "Salted Roasted Almonds"\n        ],\n        "description": "A delicious and satisfying food item suitable for snacks or meals. ideal for munching anytime. Nutty, high-protein options with a savory finish. Salted Roasted Chana are Crunchy, protein-packed roasted chickpeas lightly salted for a deliciously healthy and satisfying snack. whereas Salted Roasted Almonds are Toasty roasted almonds sprinkled with just the right amount of salt, offering a perfect balance of savory flavor and natural nuttiness."\n    },\n    "Chana Dal Masala": {\n        "variants": [],\n        "description": "Savory, crunchy, flavourful Indian snacks often enjoyed with tea, as snack or as appetizers. and ideal for munching anytime. This comforting dish is rich in protein and perfect as a nutritious vegetarian meal."\n    },\n    "Spicy Boondi": {\n        "variants": [],\n        "description": "A delicious and satisfying food item suitable for snacks or meals. ideal for munching anytime. Tiny fried gram balls coated with spices, often added to raita."\n    },\n    "All in One Mixture": {\n        "variants": [],\n        "description": "Savory, crunchy, flavorful Indian snacks blend combining a variety of crunchy ingredients—like sev, peanuts, boondi, and spiced lentils—into one irresistible mix. Perfectly seasoned with traditional Indian spices, it\'s the ideal balance of taste, texture, and satisfaction in every bite. Great for tea-time, parties, or anytime cravings.}\n}\nProduct dictionary contains products as a dictionary which further contains particular product variants available with their short description (but not limited to if you can think if additional discription you can include it at the time of making recommendations). You should recommend only one variant of a particular product (If you can\'t decide between variants which one to recommend you can choose any one at random from all of those variants listed). For the top three products on recommendation only recommend products which are not combo with other(e.g. Muesli should always be recommended with milk never recommended alone, and Malabar parata should always be recommended with pickles never alone so these products should be recommended as combos other than top three products recommended and you also have to recommend top three combos with top three products(If there is no combo that you can think of from user input(i.e. VAD and intent) you can recommend any three combos at random.), in case of chips and puffs you can recommend them in bundles as single product as well. And one more thing during recommendation in case of products with variants use the name of variant on recommendation not the product name(e.g. if you are considering recommending chips never show chips in the recommendation output only write the final variant name that you decided to recommend.\n\nBelow are the use cases(but not limited to If you can think of more you should consider including them as well before making recommendations) they explain different cases and their different behavior but I am not limiting you to these use cases only you can use your own analysis and consider these use cases as well in your analysis, If you find and of these thing contradictory to you analysis you are free to go with your own analysis and ignore these use cases:\n{\n    "VAD_Dimensions": {\n        "Valence": {\n            "description": "Pleasantness of emotion",\n            "scale": "-1 (very unpleasant) to +1 (very pleasant)"\n        },\n        "Arousal": {\n            "description": "Energy or intensity level of emotion",\n            "scale": "-1 (very calm) to +1 (very energized)"\n        },\n        "Dominance": {\n            "description": "Sense of control over the emotional state",\n            "scale": "-1 (helpless) to +1 (in control)"\n        }\n    },\n    "Food_Influences_By_Dimension": {\n        "Valence": {\n            "High": {\n                "emotions": [\n                    "Joyful",\n                    "Content"\n                ],\n                "food_behavior": "Celebratory or indulgent foods, sweets, mindful or social eating"\n            },\n            "Low": {\n                "emotions": [\n                    "Sad",\n                    "Anxious",\n                    "Bored"\n                ],\n                "food_behavior": "Comfort eating: high sugar, fat, salt, crunchy or chewy textures"\n            }\n        },\n        "Arousal": {\n            "High": {\n                "emotions": [\n                    "Excited",\n                    "Stressed",\n                    "Angry"\n                ],\n                "food_behavior": "Quick snacks, crunchy textures, emotional or rapid eating"\n            },\n            "Low": {\n                "emotions": [\n                    "Calm",\n                    "Bored",\n                    "Depressed"\n                ],\n                "food_behavior": "Comfort food, grazing/snacking, boredom eating or mindful eating"\n            }\n        },\n        "Dominance": {\n            "High": {\n                "emotions": [\n                    "Confident",\n                    "In control"\n                ],\n                "food_behavior": "Mindful, planned, healthy or goal-aligned choices"\n            },\n            "Low": {\n                "emotions": [\n                    "Helpless",\n                    "Overwhelmed"\n                ],\n                "food_behavior": "Impulsive or out-of-control eating, often comfort food"\n            }\n        }\n    },\n    "Combined_VAD_Profiles": {\n        "HighV_HighA_HighD": {\n            "emotions": [\n                "Excited",\n                "Confident"\n            ],\n            "food_behavior": "Celebratory, rich food, enjoyed socially"\n        },\n        "HighV_LowA_HighD": {\n            "emotions": [\n                "Content",\n                "Peaceful"\n            ],\n            "food_behavior": "Mindful, healthy eating"\n        },\n        "LowV_HighA_LowD": {\n            "emotions": [\n                "Anxious",\n                "Stressed",\n                "Helpless"\n            ],\n            "food_behavior": "Emotional or binge eating, comfort food"\n        },\n        "LowV_LowA_LowD": {\n            "emotions": [\n                "Depressed",\n                "Bored",\n                "Powerless"\n            ],\n            "food_behavior": "Mindless comfort eating, sweet or heavy foods"\n        },\n        "LowV_HighA_HighD": {\n            "emotions": [\n                "Frustrated",\n                "Angry"\n            ],\n            "food_behavior": "Crunchy food for tension release, variable appetite"\n        },\n        "LowV_LowA_HighD": {\n            "emotions": [\n                "Resigned",\n                "Low Mood"\n            ],\n            "food_behavior": "Unhealthy choices with controlled quantity"\n        }\n    },\n    "Food_Type_Mapping": {\n        "Sweet": {\n            "typical_VAD": [\n                "LowV",\n                "LowA or HighA"\n            ],\n            "reason": "Boost mood, reward system, serotonin uplift"\n        },\n        "Salty_Tangy": {\n            "typical_VAD": [\n                "HighA",\n                "LowV"\n            ],\n            "reason": "Stress relief, sensory distraction, crunch for tension"\n        },\n        "Crunchy": {\n            "typical_VAD": [\n                "HighA",\n                "LowD"\n            ],\n            "reason": "Physical release of tension or dominance compensation"\n        },\n        "Light": {\n            "typical_VAD": [\n                "HighV",\n                "LowA",\n                "HighD"\n            ],\n            "reason": "Health-aligned, mindful, soothing in high stress"\n        },\n        "Heavy": {\n            "typical_VAD": [\n                "LowV",\n                "LowD",\n                "Any A"\n            ],\n            "reason": "Comfort, fullness, grounding against helplessness or sadness"\n        }\n    }\n}\nIn case of some bottlenecks you should proceed in the way below:\n1. In case of user requesting "light" product while having a VAD profile that suggests a "Heavy" product. You should give preference to user preference of light product instead of VAD profile suggesting Heavy product.\n2. In case of user has multiple intents (e.g., ["Hot", "Light", "Healthy"]), the system might struggle to prioritize or combine these intents accurately. here you can choose which intent to prioritize and which one to drop, if you are struggling to recommend product based on these intent. BUT don\'t make it a habit of dropping or ignoring intent consider all of the intents wherever possible.\n3. The system categorizes products into types (e.g., Sweet, Salty, Crunchy). However, some products might belong to multiple categories or have ambiguous categorization, leading to inconsistent recommendations: In this case where the product belongs to multiple categories you can use them recommending into multiple profiles as well instead of only listed types.\n4. In case of multiple variants where system struggle to choose between them, it can decide randomly between the variants.\n5. In case of generating combos if you are unable to find combos matching to user\'s VAD and intent, you can decide other combos randomly and recommend them.\n6. Use contextual data only to rearrange the recommended products, If you can\'t use contextual data it is not a must but use contextual data wherever possible.\n\nIn case of recommending products and combos which contain variants don\'t recommend as "Makhana - Roasted Makhana" Instead recommend only "Roasted Makhana". And in case of Combos there are very randomness (i.e. products are combined without any match between them(e.g. Mango Yogurt & Muesli and Flakes - Muesli where Mango Yogurt has no combo with Muesli.)) In the product dictionary there is explicitly mentioned which product can be combined with other products. So I want you to use that information to recommend combos not any random combination to make.\n\n\nIn the output what you must include is(and the output should be in JSON):\n1. Emotion of the user from the VAD score limiting it to only two words (i.e. those two words should be self-explanatory about the user\'s emotion). If there is a way to write it in only one word then there is no need to write two words for emotion.\n2. Top three products recommended as a list.\n3. Top three combos recommended as a list.\n'}, {'role': 'user', 'content': "[[-0.25, 0.35, 0.15], ['Hot', 'Light', 'Tangy'], ['22:16:31', '2025-05-29', 'Delhi, Delhi, IN', '38.32°C, scattered clouds']]"}], 'model': 'meta-llama/llama-4-scout-17b-16e-instruct', 'max_completion_tokens': 1024, 'response_format': {'type': 'json_object'}, 'stop': None, 'stream': False, 'temperature': 2, 'top_p': 1}}
2025-05-29 22:16:32,422 - groq._base_client - DEBUG - Sending HTTP Request: POST https://api.groq.com/openai/v1/chat/completions
2025-05-29 22:16:32,422 - httpcore.connection - DEBUG - connect_tcp.started host='api.groq.com' port=443 local_address=None timeout=5.0 socket_options=None
2025-05-29 22:16:32,495 - httpcore.connection - DEBUG - connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001C2396666E0>
2025-05-29 22:16:32,496 - httpcore.connection - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x000001C242FC92C0> server_hostname='api.groq.com' timeout=5.0
2025-05-29 22:16:32,551 - httpcore.connection - DEBUG - start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x000001C239666530>
2025-05-29 22:16:32,551 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2025-05-29 22:16:32,551 - httpcore.http11 - DEBUG - send_request_headers.complete
2025-05-29 22:16:32,551 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2025-05-29 22:16:32,551 - httpcore.http11 - DEBUG - send_request_body.complete
2025-05-29 22:16:32,551 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2025-05-29 22:16:34,076 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 29 May 2025 16:46:33 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Cache-Control', b'private, max-age=0, no-store, no-cache, must-revalidate'), (b'vary', b'Origin'), (b'x-groq-region', b'gcp-asia-south1'), (b'x-ratelimit-limit-requests', b'1000'), (b'x-ratelimit-limit-tokens', b'30000'), (b'x-ratelimit-remaining-requests', b'999'), (b'x-ratelimit-remaining-tokens', b'23878'), (b'x-ratelimit-reset-requests', b'1m26.4s'), (b'x-ratelimit-reset-tokens', b'12.244s'), (b'x-request-id', b'req_01jwef0c2kf2dte50j1b8kjpff'), (b'cf-cache-status', b'DYNAMIC'), (b'Set-Cookie', b'__cf_bm=UAL4zVi59KSMfSDCoGk6FMO0pnXRtBzHZpY5j1pn9a4-1748537193-1.0.1.1-4SLapVw1o5kZQJlgN.GGfGAKm4phVpEkZDjoFdZCf1ErZogFp_sMaQFbBbe4rLiU3xzW5Th43sl39cIIlfTgvr9Mlq371DHgNmm0BSddTtg; path=/; expires=Thu, 29-May-25 17:16:33 GMT; domain=.groq.com; HttpOnly; Secure; SameSite=None'), (b'Server', b'cloudflare'), (b'CF-RAY', b'947777ecdc164823-BOM'), (b'Content-Encoding', b'gzip'), (b'alt-svc', b'h3=":443"; ma=86400')])
2025-05-29 22:16:34,077 - httpx - INFO - HTTP Request: POST https://api.groq.com/openai/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-29 22:16:34,077 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2025-05-29 22:16:34,077 - httpcore.http11 - DEBUG - receive_response_body.complete
2025-05-29 22:16:34,077 - httpcore.http11 - DEBUG - response_closed.started
2025-05-29 22:16:34,077 - httpcore.http11 - DEBUG - response_closed.complete
2025-05-29 22:16:34,077 - groq._base_client - DEBUG - HTTP Response: POST https://api.groq.com/openai/v1/chat/completions "200 OK" Headers({'date': 'Thu, 29 May 2025 16:46:33 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'cache-control': 'private, max-age=0, no-store, no-cache, must-revalidate', 'vary': 'Origin', 'x-groq-region': 'gcp-asia-south1', 'x-ratelimit-limit-requests': '1000', 'x-ratelimit-limit-tokens': '30000', 'x-ratelimit-remaining-requests': '999', 'x-ratelimit-remaining-tokens': '23878', 'x-ratelimit-reset-requests': '1m26.4s', 'x-ratelimit-reset-tokens': '12.244s', 'x-request-id': 'req_01jwef0c2kf2dte50j1b8kjpff', 'cf-cache-status': 'DYNAMIC', 'set-cookie': '__cf_bm=UAL4zVi59KSMfSDCoGk6FMO0pnXRtBzHZpY5j1pn9a4-1748537193-1.0.1.1-4SLapVw1o5kZQJlgN.GGfGAKm4phVpEkZDjoFdZCf1ErZogFp_sMaQFbBbe4rLiU3xzW5Th43sl39cIIlfTgvr9Mlq371DHgNmm0BSddTtg; path=/; expires=Thu, 29-May-25 17:16:33 GMT; domain=.groq.com; HttpOnly; Secure; SameSite=None', 'server': 'cloudflare', 'cf-ray': '947777ecdc164823-BOM', 'content-encoding': 'gzip', 'alt-svc': 'h3=":443"; ma=86400'})
2025-05-29 22:16:34,087 - food_recommendations - INFO - Food recommendations received: {'user_emotion': 'Mild Stress', 'top_products': ['Taaza Jeera Chaach', 'Roasted Makhana - Salt & Pepper', 'Mixed Fruit Jam'], 'top_combos': ['Mango Yogurt & Muesli and Flakes - Muesli', 'Butter & Malabar Parata', 'Chips - Magic Masala - Potato Chips & No Maida Puffs - Disney Cream & Onion Puffs']}
